{"version":3,"file":"lag.js","sources":["../../../src/vector/lag.ts"],"sourcesContent":["type LagOptions = {\n  /** Number of positions to lag by (default: 1) */\n  n?: number;\n  /** The default value for non-existent rows. */\n  default?: any;\n};\n\n/**\n * Returns a function that lags a vector by a specified offset (n). Useful for\n * finding previous values to compute deltas with later.\n * @param key The key or accessor to lag\n * @param options Options to configure roll. e.g. whether to run on partial windows.\n */\nexport function lag<T extends object>(\n  key: keyof T | ((d: T, index: number, array: Iterable<T>) => any),\n  options?: LagOptions | undefined | null\n) {\n  const keyFn = typeof key === 'function' ? key : (d: T) => d[key];\n\n  const { n = 1, default: defaultValue } = options ?? {};\n\n  return (items: T[]) => {\n    return items.map((_, i) => {\n      const lagItem = items[i - n];\n      return lagItem == null ? defaultValue : keyFn(lagItem, i, items);\n    });\n  };\n}\n"],"names":[],"mappings":";;;;aAcE,KACA;AAEA,QAAM,QAAQ,OAAO,QAAQ,aAAa,MAAM,CAAC,MAAS,EAAE;AAE5D,QAAM,CAAE,IAAI,GAAG,SAAS,gBAAiB,4BAAW;AAEpD,SAAO,CAAC;AACN,WAAO,MAAM,IAAI,CAAC,GAAG;AACnB,YAAM,UAAU,MAAM,IAAI;AAC1B,aAAO,WAAW,OAAO,eAAe,MAAM,SAAS,GAAG;AAAA;AAAA;AAAA;;;;"}